module.exports = (msg) => {
  const [command, ...variables] = msg.split(" ");

  joinQuotes(variables);

  return { command, variables };
};

function joinQuotes(variables) {
  for (let index in variables) {
    index = Number(index);
    if (!variables[index].includes('"')) continue;
    const plusIndex = index + 1;

    //Take a slice starting from index to the end and then find the first quote to match
    const nextIndex =
      variables.slice(plusIndex - variables.length).findIndex((value) => value.includes('"')) +
      plusIndex;

    if (nextIndex == -1) continue;

    const variable = [];

    for (let i = index; i <= nextIndex; i++) variable.push(variables[i].replaceAll('"', ""));

    variables.splice(index, nextIndex - index + 1, variable.join(" "));
  }
}
