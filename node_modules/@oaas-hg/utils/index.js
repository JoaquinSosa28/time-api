const fs = require("fs");
const path = require("path");

const MODULES_FORMAT = ".js";
const MODULES_FOLDER = "modules";

function getModules() {
  const modules = fs.readdirSync(path.join(__dirname, MODULES_FOLDER));
  if (!modules || !modules.length) return {};

  let modulesToExport = {};

  for (const moduleName of modules) {
    if (!moduleName.includes(MODULES_FORMAT)) continue;
    const module = require(path.join(__dirname, MODULES_FOLDER, moduleName));

    if (typeof module === "object") modulesToExport = { ...modulesToExport, ...module };
    else modulesToExport[transformName(moduleName, MODULES_FORMAT)] = module;
  }

  return modulesToExport;
}

function transformName(fileName, format, splitter = "-") {
  fileName = fileName.replaceAll(format, "");
  const splitName = fileName.split(splitter);
  for (let i = 1; i < splitName.length; i++)
    splitName[i] = splitName[i].charAt(0).toUpperCase() + splitName[i].slice(1);

  return splitName.join("");
}

module.exports = getModules();
